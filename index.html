<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add Data</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <h1 class="my-4">Add Data</h1>
      <form id="dataForm">
        <div class="mb-3">
          <label for="name" class="form-label">Player Name</label>
          <input
            type="text"
            class="form-control"
            name="name"
            id="name"
            required
          />
        </div>

        <div class="mb-3">
          <label for="role" class="form-label">Player Role</label>
          <input
            type="text"
            class="form-control"
            name="role"
            id="role"
            required
          />
        </div>

        <div class="mb-3">
          <label for="born" class="form-label">Player Born</label>
          <input type="date" class="form-control" name="born" id="born" />
        </div>

        <div class="mb-3">
          <label for="birthplace" class="form-label">Player Birth Place</label>
          <input
            type="text"
            class="form-control"
            name="birthplace"
            id="birthplace"
            required
          />
        </div>

        <div class="mb-3">
          <label for="battingstyle" class="form-label"
            >Player Batting Style</label
          >
          <input
            type="text"
            class="form-control"
            name="battingstyle"
            id="battingstyle"
            required
          />
        </div>

        <div class="mb-3">
          <label for="bowlingstyle" class="form-label"
            >Player Bowling Style</label
          >
          <input
            type="text"
            class="form-control"
            name="bowlingstyle"
            id="bowlingstyle"
            required
          />
        </div>

        <div class="mb-3">
          <label for="debut" class="form-label">Player Debut</label>
          <input type="date" class="form-control" name="debut" id="debut" />
        </div>

        <div class="mb-3">
          <label for="image" class="form-label">Player Image</label>
          <input
            type="file"
            class="form-control"
            name="image"
            id="image"
            accept="image/*"
          />
        </div>

        <button type="submit" class="btn btn-primary">Save Data</button>
        <a type="button" class="btn btn-primary" href="/update">Update Runs</a>
      </form>
    </div>

    <!-- Bootstrap JS (optional if you're not using Bootstrap's JavaScript components) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <script>
      document
        .getElementById("dataForm")
        .addEventListener("submit", async function (event) {
          event.preventDefault();

          const formData = new FormData(this);

          // Convert image to base64
          const imageFile = formData.get("image");
          const base64Image = await convertToBase64(imageFile);

          const requestData = {
            name: formData.get("name"),
            role: formData.get("role"),
            born: formData.get("born"),
            birthplace: formData.get("birthplace"),
            battingstyle: formData.get("battingstyle"),
            bowlingstyle: formData.get("bowlingstyle"),
            debut: formData.get("debut"),
            image: base64Image,
          };
          console.log(requestData);
          try {
            const response = await fetch(
              "https://teamawesomebackend.onrender.com/api/data",
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(requestData),
              }
            );
            if (!response.ok) {
              throw new Error("Failed to save data");
            }

            alert("Player added successfully!");

            this.reset();
          } catch (error) {
            console.error(error);
            alert("An error occurred while adding player");
          }
        });

      function convertToBase64(file) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.readAsDataURL(file);
          reader.onload = () => resolve(reader.result.split(",")[1]);
          reader.onerror = (error) => reject(error);
        });
      }
    </script>
  </body>
</html>
